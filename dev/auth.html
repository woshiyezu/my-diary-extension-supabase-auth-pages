<script type="module">
  import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";
  const supabase = createClient(
    "https://hfqfrbbzxlwwrcugejyj.supabase.co",
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhmcWZyYmJ6eGx3d3JjdWdlanlqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIzNDMxODgsImV4cCI6MjA2NzkxOTE4OH0.TCg39SxJSzbiNO4weBZF94ElxOAeC-efTcH5KkIbi70"
  );

  const { data, error } = await supabase.auth.getSession();
  if (data?.session) {
    const token = data.session.access_token;
    // 👇 拡張内の close.html にリダイレクト
    location.href = `chrome-extension://gijeljnppkaoidcndjbcgbbjfkhcjlki/close.html?token=${token}`;
  } else {
    document.body.innerText = "ログインに失敗しました";
  }
</script>
